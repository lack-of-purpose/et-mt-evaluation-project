<!DOCTYPE html>
<html>
<head>
	<title>Multi-Screen Text Viewer</title>
    <style>
		/* Style for the screens */
		.screen {
			display: none;
			width: 100%;
			font-size: 36px;
			margin-top: 50px;
		}
		
		/* Style for the "Next" button */
		.next-button {
			display: block;
			margin-top: 20px;
			padding: 10px 20px;
			border: none;
			background-color: #007bff;
			color: #fff;
			font-size: 20px;
			cursor: pointer;
		}

		.stop-button {
			display: block;
			margin-top: 20px;
			padding: 10px 20px;
			border: none;
			background-color: #007bff;
			color: #fff;
			font-size: 20px;
			cursor: pointer;
		}

		.choice-button {
			display: block;
			margin-top: 20px;
			padding: 10px 20px;
			border: none;
			background-color: #92a8d1;
			color: #fff;
			font-size: 16px;
			cursor: pointer;
		}
		
		/* Style for the clicked words */
		.clicked {
			background-color: #ffc107;
			color: #000;
			font-weight: bold;
		}
	</style>
</head>
<body>
	<!-- Screens -->
	<div class="screen" id="screen-1">
		<!--<h1>Screen 1</h1> -->
		<p>MT Experiment</p>
        <button class="start-button" id="start-button" onclick="startButtonClick()">Start</button>
	</div>
	<div class="screen" id="screen-2">
		<!--<h1>Screen 2</h1>-->
		<p>But you’re going to fucking tell me which procedure you would recommend, because I don’t know another one that is gonna help this poor kid”.</p>
        <p>1. Но ты, блядь, скажешь мне, какую процедуру ты бы порекомендовал, потому что я не знаю другой, которая помогла бы этому бедному ребенку”.</p>
		<button class="choice-button" id="choice-button" onclick=" choice1Click()">1</button>
		<br>
		<p>2. Но ты собираешься, черт возьми, сказать мне, какую процедуру ты бы порекомендовал, потому что я не знаю другой, которая поможет этому бедному парню ".</p>
		<button class="choice-button" id="choice-button" onclick=" choice2Click()">2</button>
		<button class="next-button" id="next-button" onclick="buttonClick()">Next</button>
    </div>
	<div class="screen" id="screen-3">
		<!--<h1>Screen 3</h1>-->
		<p>As it turns out this procedure is generally hated by insurance because it’s pretty expensive.</p>
		<p>1. Как оказалось, страховая компания обычно ненавидит эту процедуру, потому что она довольно дорогая.</p>
		<button class="choice-button" id="choice-button" onclick=" choice1Click()">1</button>
		<br>
		<p>2. Как оказалось, эту процедуру обычно ненавидит страховка, потому что она довольно дорогая.</p>
		<button class="choice-button" id="choice-button" onclick=" choice2Click()">2</button>
        <button class="next-button" id="next-button" onclick="buttonClick()">Next</button>
	</div>
	<div class="screen" id="screen-4">
		<!--<h1>Screen 4</h1>-->
		<p>One of them was pretty infamous in town for always being in trouble with the law.</p>
		<p>1. Один из них был довольно печально известен в городе тем, что всегда имел проблемы с законом.</p>
		<button class="choice-button" id="choice-button" onclick=" choice1Click()">1</button>
		<br>
		<p>2. Один из них был довольно печально известен в городе тем, что всегда имел проблемы с законом.</p>
		<button class="choice-button" id="choice-button" onclick=" choice2Click()">2</button>
        <button class="next-button" id="next-button" onclick="buttonClick()">Next</button>
	</div>
	<div class="screen" id="screen-5">
		<!--<h1>Screen 5</h1>-->
		<p>Buffer screen.</p>
        <button class="next-button" id="next-button" onclick="buttonClick()">Next</button>
	</div>
	<!-- End button -->
	<button class="next-button" id="next-button" onclick="endClick()">End</button>
	
	<!-- Clicked words list -->
	<!--<h2>Clicked Words:</h2>-->
	<!--<ul id="clicked-words"></ul>-->
	
	<script>
		
		// Initialize variables
		var currentScreen = 1;
		alert(currentScreen);
		var numScreens = document.getElementsByClassName("screen").length;
		var nextButton = document.getElementById("next-button");
        var startButton = document.getElementById("start-button");
		var clickedWordsList = document.getElementById("clicked-words");
		var clickedWords = [];

		// Add click event listener to Next button
		nextButton.addEventListener("click", nextScreen);
		startButton.addEventListener("click", nextScreen); 
		
		// Function to switch between screens
		function nextScreen() {
			document.getElementById("screen-" + currentScreen).style.display = "none";
			currentScreen++;
			console.log(currentScreen);
			console.log(numScreens);
			//if (currentScreen > numScreens) {
			//	currentScreen = 1;
			//}
			document.getElementById("screen-" + currentScreen).style.display = "block";
		}
		
		// Add click event listeners to all words
		document.querySelectorAll('.screen p').forEach((paragraph) => {
			var words = paragraph.innerText.split(" ");
			paragraph.innerHTML = "";
			for (var i = 0; i < words.length; i++) {
				var word = words[i];
				var span = document.createElement("span");
				span.innerHTML = word + " ";
				span.addEventListener("click", function() {
					if (!this.classList.contains("clicked")) {
						clickedWords.push(this.innerHTML.trim());
						this.classList.add("clicked");
						var li = document.createElement("li");
						li.innerHTML = this.innerHTML.trim();
						clickedWordsList.appendChild(li);
					}
				});
				paragraph.appendChild(span);
			}
		});
		
		function buttonClick(clickedWordsList) {
			fetch('/next', { 
				method: 'POST',
				body: JSON.stringify(clickedWords),
			});
			clickedWords = [];
		}

        function startButtonClick() {
			fetch('/start', { method: 'POST' });
		}

		function choice1Click() {
			fetch('/choice1', { method: 'POST' });
		}

		function choice2Click() {
			fetch('/choice2', { method: 'POST' });
		}

		function endClick() {
			fetch('/end', { 
				method: 'POST',
				body: JSON.stringify(clickedWords),
			});
		}

		// Show the first screen
		document.getElementById("screen-1").style.display = "block";
	</script>
</body>
</html>
